(function(e){function t(t){for(var i,o,a=t[0],c=t[1],u=t[2],h=0,p=[];h<a.length;h++)o=a[h],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);l&&l(t);while(p.length)p.shift()();return n.push.apply(n,u||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],i=!0,a=1;a<s.length;a++){var c=s[a];0!==r[c]&&(i=!1)}i&&(n.splice(t--,1),e=o(o.s=s[0]))}return e}var i={},r={app:0},n=[];function o(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=i,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(s,i,function(t){return e[t]}.bind(null,i));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";s("85ec")},2419:function(e,t,s){"use strict";s("60af")},"568f":function(e,t,s){"use strict";s("c457")},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i=s("2b0e"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},n=[],o=s("5530"),a=s("2f62"),c={name:"App",mounted:function(){this.getName(),this.getScore()},methods:Object(o["a"])({},Object(a["b"])(["getName","getScore"]))},u=c,l=(s("034f"),s("2877")),h=Object(l["a"])(u,r,n,!1,null,null,null),p=h.exports,f=s("8c4f"),d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("header",[i("p",{staticClass:"username"},[e._v(e._s(e.myName))]),i("p",{staticClass:"score"},[e._v(e._s(e.myName)+" "+e._s(e.showUserScore)+":"+e._s(e.showPcScore)+" Компьютер")]),i("button",{staticClass:"refresh",on:{click:e.refresh}},[i("img",{attrs:{src:s("b7d8"),alt:""}})])]),i("div",{staticClass:"wrapper"},[1==e.curr_move?i("h1",[e._v("Ваш ход")]):i("h1",[e._v("Ходит Компьютер")]),i("div",{staticClass:"player"},[i("h2",[e._v("Компьютер")]),i("div",{staticClass:"ships"},e._l(e.pcShips,(function(e){return i("ship",{key:e.count+"i"+e.size,attrs:{count:e.count,size:e.size}})})),1),i("field",{attrs:{close:"close",field:e.pcField},on:{opencell:e.move}})],1),i("div",{staticClass:"line"}),i("div",{staticClass:"player"},[i("h2",[e._v("Вы")]),i("div",{staticClass:"ships"},e._l(e.userShips,(function(e){return i("ship",{key:e.count+"i"+e.size,attrs:{count:e.count,size:e.size}})})),1),i("field",{attrs:{close:"open",field:e.userField}})],1)])])},m=[],v=(s("7db0"),s("d3b7"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"ship",class:0==e.count?"is_end":""},[s("div",{staticClass:"ship_img"},e._l(e.size,(function(e){return s("div",{key:e,staticClass:"ship_cell"})})),0),s("p",{staticClass:"ship_count"},[e._v(e._s(e.count))])])}),b=[],_={props:["count","size"]},g=_,S=(s("2419"),Object(l["a"])(g,v,b,!1,null,null,null)),y=S.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",[s("tr",[s("td"),e._l(e.xAsix,(function(t){return s("td",{key:t,staticClass:"field_letter"},[e._v(" "+e._s(t)+" ")])}))],2),e._l(e.yAsix,(function(t){return s("tr",{key:t},[s("td",{staticClass:"field_num"},[e._v(e._s(t))]),e._l(e.yAsix,(function(i){return s("td",{key:i,staticClass:"field_cell",class:[e.close,e.cellStatus(t-1,i-1)],on:{click:function(s){return e.openCell(t-1,i-1)}}})}))],2)}))],2)},w=[],O={props:["close","field"],data:function(){return{xAsix:["А","Б","В","Г","Д","Е","Ж","З","И","К"],yAsix:10,dataField:[]}},beforeMount:function(){},methods:{openCell:function(e,t){this.$emit("opencell",{x:e,y:t})},cellStatus:function(e,t){return"close"!=this.close&&1==this.field[e][t].isShip&&"open"==this.field[e][t].status?"shipcell":this.field[e][t].status}}},j=O,M=(s("9dbd"),Object(l["a"])(j,x,w,!1,null,null,null)),k=M.exports,C=s("d4ec"),F=s("bee2"),I=(s("caad"),s("159b"),function(){function e(){Object(C["a"])(this,e)}return Object(F["a"])(e,[{key:"start",value:function(){this.pcShips=this.createShips("close"),this.pcField=this.field,this.userShips=this.createShips("open"),this.userField=this.field,this.is_move=Math.round(Math.random()),this.pc_score=20,this.user_score=20}},{key:"createShips",value:function(e){var t=this;this.cells={};var s=[];this.field=[];for(var i=0;i<10;i++){for(var r=[],n=0;n<10;n++)this.cells[10*i+n]={id:10*i+n,l:i,t:n,lchildren:10-i,tchildren:10-n,lparent:0==i?null:10*(i-1)+n,tparent:0==n?null:10*i+n-1,is_intact:!1},r.push({status:e,isShip:0});this.field.push(r)}for(var a=4;a>0;a--)for(var c=5-a;c>0;c--){var u=Math.round(Math.random()),l=[];if(this.toDel=[],1==u)for(var h in this.cells)this.cells[h].tchildren>=a&&l.push(this.cells[h]);else for(var p in this.cells)this.cells[p].lchildren>=a&&l.push(this.cells[p]);for(var f=l[Math.floor(Math.random()*l.length)],d=[],m=0;m<a;m++){var v=1==u?m:10*m;d.push(Object(o["a"])({},this.cells[f.id+v]))}s.push(d),d.forEach((function(e){t.field[e.l][e.t].isShip=1,t.clearCells(e),t.clearCells(t.cells[e.id+10]),t.clearCells(t.cells[e.id+1]),t.clearCells(t.cells[e.lparent]),t.clearCells(t.cells[e.tparent])}))}return s}},{key:"clearCells",value:function(e){if(void 0!=e){var t=this.cells[e.tparent],s=this.cells[e.lparent],i=1;while(void 0!=t)t.tchildren=i,t=this.cells[t.tparent],i++;i=1;while(void 0!=s)s.lchildren=i,s=this.cells[s.lparent],i++;delete this.cells[e.id]}}},{key:"move",value:function(e,t){var s=this.is_move?this.pcField:this.userField;if(["fail","hurt","kill"].includes(s[e][t].status))return{status:"one_more"};if(0==s[e][t].isShip)return this.is_move=Math.abs(this.is_move-1),s[e][t].status="fail",{status:"fail"};if(this.is_move){if(this.pc_score--,0==this.pc_score)return{status:"kill",game:"gameover",result:"win"}}else if(this.user_score--,0==this.user_score)return{status:"kill",game:"gameover",result:"fail"};for(var i=this.is_move?this.pcShips:this.userShips,r=null,n=null,o=0;o<i.length;o++)if(r=i[o].find((function(s){return s.id==10*e+t})),r){r.is_intact=!0,n=i[o];break}var a=n.reduce((function(e,t){return t.is_intact?e+1:e}),0);return a==n.length?(n.forEach((function(e){s[e.l][e.t].status="kill"})),{status:"kill",size:n.length}):(s[e][t].status="hurt",{status:"hurt"})}}]),e}()),N=(s("a434"),s("c740"),s("99af"),s("4de4"),s("4e82"),s("a630"),s("3ca3"),s("6062"),s("ddb0"),function(){function e(t){Object(C["a"])(this,e),this.game=t,this.create()}return Object(F["a"])(e,[{key:"create",value:function(){this.moves=[];for(var e=0;e<10;e++)for(var t=0;t<10;t++)this.moves.push({x:e,y:t,id:10*e+t});this.probableMoves=[],this.ship=[]}},{key:"move",value:function(){var e,t,s;return this.probableMoves.length>0?(e=Math.random()*this.probableMoves.length,e=this.probableMoves.splice(e,1)[0].id,e=this.moves.findIndex((function(t){return t.id==e}))):e=Math.random()*this.moves.length,t=this.moves.splice(e,1)[0],s=this.game.move(t.x,t.y),"hurt"==s.status&&(this.ship.push(Object(o["a"])({},t)),this.createProbableMoves()),"kill"==s.status&&(this.ship.push(Object(o["a"])({},t)),this.clearField()),s}},{key:"clearField",value:function(){var e=this,t=[];this.ship.forEach((function(s){var i=e.getIndexes(s);t=t.concat(i.filter((function(e){return e>=0})))})),t=Array.from(new Set(t)).sort((function(e,t){return e-t}));for(var s=0;s<t.length;s++)this.moves.splice(t[s]-s,1);this.probableMoves=[],this.ship=[]}},{key:"getIndexes",value:function(e){var t=[];return e.y<9&&t.push(this.moves.findIndex((function(t){return t.id==e.id+1}))),e.y>0&&t.push(this.moves.findIndex((function(t){return t.id==e.id-1}))),e.x<9&&t.push(this.moves.findIndex((function(t){return t.id==e.id+10}))),e.x>0&&t.push(this.moves.findIndex((function(t){return t.id==e.id-10}))),t.filter((function(e){return e>=0}))}},{key:"createProbableMoves",value:function(){var e=this;this.ship.sort((function(e,t){return e.id-t.id}));var t=[];if(1==this.ship.length)return t=this.getIndexes(this.ship[0]),void t.forEach((function(t){e.probableMoves.push(Object(o["a"])({},e.moves[t]))}));this.probableMoves=[],this.ship[this.ship.length-1].id-this.ship[0].id>=10?(this.ship[0].x>0&&t.push(this.moves.findIndex((function(t){return t.id==e.ship[0].id-10}))),this.ship[this.ship.length-1].x<9&&t.push(this.moves.findIndex((function(t){return t.id==e.ship[e.ship.length-1].id+10})))):(this.ship[0].y>0&&t.push(this.moves.findIndex((function(t){return t.id==e.ship[0].id-1}))),this.ship[this.ship.length-1].y<9&&t.push(this.moves.findIndex((function(t){return t.id==e.ship[e.ship.length-1].id+1})))),t=t.filter((function(e){return e>=0})),t.forEach((function(t){e.probableMoves.push(Object(o["a"])({},e.moves[t]))}))}}]),e}()),z=new I,P=new N(z),E={components:{Ship:y,Field:k},data:function(){return{userShips:[],pcShips:[],pcField:"",userField:"",curr_move:1,stat:{},game:"starting"}},computed:Object(o["a"])({},Object(a["c"])(["myName","showUserScore","showPcScore"])),beforeMount:function(){this.start()},mounted:function(){0==this.curr_move&&this.pcMove()},methods:Object(o["a"])({start:function(){z.start(),P.create(),this.userField=z.userField,this.pcField=z.pcField,this.curr_move=z.is_move,this.stat={},this.game="starting",this.userShips=[],this.pcShips=[],this.createShips()},createShips:function(){for(var e=4;e>0;e--)this.userShips.push({size:e,count:5-e}),this.pcShips.push({size:e,count:5-e})},pcMove:function(){var e=this;setTimeout((function(){e.stat=P.move(),e.updateField(),"gameover"!=e.stat.game?"fail"!=e.stat.status&&"starting"==e.game?(e.pcMove(),"kill"==e.stat.status&&e.userShips.find((function(t){return e.stat.size==t.size})).count--):e.curr_move=Math.abs(e.curr_move-1):e.game="stop"}),1e3)},move:function(e){var t=this;if(1==this.curr_move){if(this.stat=z.move(e.x,e.y),this.updateField(),"gameover"==this.stat.game)return void(this.game="stop");"fail"==this.stat.status&&(this.curr_move=Math.abs(this.curr_move-1)),"kill"==this.stat.status&&this.pcShips.find((function(e){return t.stat.size==e.size})).count--,0==this.curr_move&&this.pcMove()}},updateField:function(){this.pcField=z.pcField,this.userField=z.userField},endGame:function(){z.start(),this.updateField()}},Object(a["d"])(["refresh","incrementScore"])),watch:{game:function(){"stop"==this.game&&("win"==this.stat.result?this.incrementScore("user"):this.incrementScore("pc"),this.$router.push({name:"End",params:{result:"win"==this.stat.result?"Вы победили":"Вы проиграли"}}))}}},$=E,A=(s("568f"),Object(l["a"])($,d,m,!1,null,null,null)),U=A.exports,T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("div",{staticClass:"wrapper"},[s("h1",[e._v(e._s(e.result))]),s("router-link",{attrs:{to:"/game"}},[s("button",[e._v("Заново")])])],1)])},J=[],D={props:["result"]},G=D,q=(s("7e52"),Object(l["a"])(G,T,J,!1,null,"846b93a2",null)),B=q.exports,H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",[s("div",{staticClass:"starting"},[e.myName?s("div",{staticClass:"welcome"},[s("h1",[e._v("Привет, "+e._s(e.myName))]),s("button",{staticClass:"start",on:{click:e.start}},[e._v("Игра")])]):s("div",{staticClass:"welcome"},[s("h1",[e._v("Давай познакомимся")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.new_name,expression:"new_name"}],attrs:{type:"text",placeholder:"Введи своё имя"},domProps:{value:e.new_name},on:{input:function(t){t.target.composing||(e.new_name=t.target.value)}}}),s("button",{staticClass:"start",on:{click:function(t){return e.rememberMe()}}},[e._v("Запомнить меня")])])])])},K=[],L=(s("498a"),{data:function(){return{new_name:""}},computed:Object(a["c"])(["myName"]),methods:Object(o["a"])({rememberMe:function(){this.new_name.trim()&&this.setName(this.new_name)},start:function(){this.$router.push("/game")}},Object(a["b"])(["setName"]))}),Q=L,R=Object(l["a"])(Q,H,K,!1,null,null,null),V=R.exports;i["a"].use(f["a"]);var W=[{path:"/",component:V},{path:"/game",component:U},{path:"/end",name:"End",component:B,props:!0}],X=new f["a"]({base:"/",routes:W}),Y=X,Z=(s("b0c0"),{actions:{getName:function(e){var t=localStorage.getItem("username");void 0!=t&&t.trim(),t&&e.commit("updateName",t)},setName:function(e,t){localStorage.setItem("username",t),e.commit("updateName",t)}},mutations:{updateName:function(e,t){e.name=t}},state:{name:""},getters:{myName:function(e){return e.name}}}),ee={actions:{getScore:function(e){var t=localStorage.getItem("userscore"),s=localStorage.getItem("pcscore");t||(t=0),s||(s=0),e.commit("updateUserScore",t),e.commit("updatePcScore",s)}},mutations:{updateUserScore:function(e,t){t=parseInt(t),e.userScore=t},updatePcScore:function(e,t){t=parseInt(t),e.pcScore=t},incrementScore:function(e,t){"user"==t?(e.userScore++,localStorage.setItem("userscore",e.userScore)):(e.pcScore++,localStorage.setItem("pcscore",e.pcScore))},refresh:function(e){e.userScore=0,e.pcScore=0,localStorage.setItem("userscore",0),localStorage.setItem("pcScore",0)}},state:{userScore:0,pcScore:0},getters:{showUserScore:function(e){return e.userScore},showPcScore:function(e){return e.pcScore}}};i["a"].use(a["a"]);var te=new a["a"].Store({modules:{user:Z,score:ee}});i["a"].config.productionTip=!1,new i["a"]({store:te,router:Y,render:function(e){return e(p)}}).$mount("#app")},"60af":function(e,t,s){},"7e52":function(e,t,s){"use strict";s("aa16")},"85ec":function(e,t,s){},"9dbd":function(e,t,s){"use strict";s("e196")},aa16:function(e,t,s){},b7d8:function(e,t,s){e.exports=s.p+"img/refresh.bea118bc.svg"},c457:function(e,t,s){},e196:function(e,t,s){}});
//# sourceMappingURL=app.a86a18f5.js.map